<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ba049edb09c949c68b4bdd993aa729eb</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> drange</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> patsy <span class="im">import</span> dmatrices</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.9/site-packages/statsmodels/compat/pandas.py:65: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import Int64Index as NumericIndex
</code></pre>
</div>
</div>
<section id="did-dream-make-or-break-the-minecraft-speedrunning-scene" class="cell markdown" data-tags="[]">
<h1>Did Dream Make or Break the Minecraft Speedrunning Scene?</h1>
<h3 id="a-data-analysis-by-johnny-rajala">A data analysis by Johnny Rajala</h3>
</section>
<section id="introduction" class="cell markdown" data-jp-MarkdownHeadingCollapsed="true" data-tags="[]">
<h2>Introduction</h2>
</section>
<div class="cell markdown">
<p>Many people play video games, but there is a growing community of people who enjoy an extra challenge: finishing the game as fast as possible. For practically every game, there is a speedrunning scene. In the early days of speedrunning, the practice was incredibly niche and splintered on various websites. But over the past 2 decades Speedrunning.com has become the biggest congregation of speedrunning content on the internet. As a member of the Minecraft: Java Edition speedrunning scene, I noticed an interesting phenomenon: the number of speedruns submitted during quarantine has exploded, to the point where moderation became backlogged. Many runners have assumed the spare time during quarantine, but I posit one particular runner, Dream, may have an outstanding effect.</p>
</div>
<section id="collecting-the-data" class="cell markdown" data-jp-MarkdownHeadingCollapsed="true" data-tags="[]">
<h2>Collecting the data</h2>
</section>
<div class="cell markdown">
<p>Thankfully, Speedrun.com provides a rest API for us to pull information about games, leaderboards, and even individual runs. The API requires a header that briefly describes the use, which we do here:</p>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>init_headers <span class="op">=</span> {<span class="st">&#39;User-Agent&#39;</span>: <span class="st">&#39;uni-project-bot/1.0&#39;</span>}</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Now we can pull every game that is on Speedrun.com. We can request the IDs of games, which are used to uniquely identify them, and are useful for gaining more important information later.</p>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If data is already in directory, load that</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.isfile(<span class="st">&quot;game_IDs.txt&quot;</span>): <span class="co"># if file exists we have already pickled a list</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;game_IDs.txt&quot;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        game_IDs <span class="op">=</span> pickle.load(f)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Request every game in batches of 1000</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    game_IDs <span class="op">=</span> []</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(<span class="va">True</span>):</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Request and unpack 1000 games</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        URL <span class="op">=</span> <span class="st">&#39;https://www.speedrun.com/api/v1/games?_bulk=yes&amp;max=1000&amp;offset=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(offset)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(URL, init_headers)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> response.json()[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add each game to array</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> game <span class="kw">in</span> data:</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            game_IDs.append(game[<span class="st">&#39;id&#39;</span>])</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        offset <span class="op">+=</span> <span class="dv">1000</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If length is less than max, we break</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(game_IDs))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>28755
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We see that in all, there are over 28 thousand games on Speedrun.com! With the IDs we can now pull and store all the data we need. Here is the dataframe we will use, and we collect data in the following categories:</p>
<ul>
<li><p>Game: This is the international name of the game</p></li>
<li><p>Category: The category of the speedrun, which defines the leaderboard. A game can have multiple types of speedruns, such as beating the full game vs. a signle level, and the category differentiates these types. It can be split into further subcategories with the values.</p></li>
<li><p>Run Time: The length of the speedrun, defined as whatever time is used for rankings on the leaderboard, in seconds</p></li>
<li><p>Date: The date the speedrun was submitted (not always present), in Year-Month-Day format</p></li>
<li><p>Values: Set of aspects of a run that can put it in a subcategory, such as using glitches vs. glitchless. Only present if it creates a subcategory. The values combined with the category designate what 'type' of run a person is submitting</p></li>
<li><p>Game ID, Cat ID: Unique identifiers the API uses for finding games and categories</p></li>
</ul>
<p>Note that the API returns runs that are current to the date of data collection, so future runs of data collection may look different as it will include runs which did not exist at the time I collected.</p>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">&#39;Game&#39;</span>,<span class="st">&#39;Category&#39;</span>,<span class="st">&#39;Run Time&#39;</span>,<span class="st">&#39;Date&#39;</span>,<span class="st">&#39;Values&#39;</span>, <span class="st">&#39;Game ID&#39;</span>, <span class="st">&#39;Cat ID&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Finally, we use our game IDs to collect the data! For each game, we collect every <em>verified</em> run that was ever submitted to a leaderboard. This means no runs that were rejected. This also means we are essentially collecting the entire speedrun history of a game.</p>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#game_IDs = [&#39;j1npme6p&#39;]</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> os.getcwd()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>path <span class="op">+=</span> <span class="st">&#39;/FinalData(2)&#39;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If data is already in directory, load that</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.isfile(path):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(<span class="st">&#39;FinalData(2)&#39;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    df.drop(<span class="st">&#39;Unnamed: 0&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Else, collect the data</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    maxim <span class="op">=</span> <span class="dv">200</span> <span class="co"># Max number of runs we pull at a time, 200 is maximum allowed</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    sec <span class="op">=</span> <span class="dv">15</span> <span class="co"># Cooldown time for when </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    track <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extracts all runs for each game, stores them in df</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Currently accounting for crash!!! Starting from where it crashed</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> game_ID <span class="kw">in</span> tqdm(game_IDs):</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Every 100 games save the dataframe to disk</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        track <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> track <span class="op">%</span> <span class="dv">500</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            cwd <span class="op">=</span> os.getcwd()</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> cwd <span class="op">+</span> <span class="st">&quot;/DataV&quot;</span> <span class="op">+</span> <span class="bu">str</span>(track<span class="op">/</span><span class="dv">500</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>            df.to_csv(path)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        same <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get info about game, categories, and variables</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        URL <span class="op">=</span> <span class="st">&#39;https://www.speedrun.com/api/v1/games/&#39;</span> <span class="op">+</span> <span class="bu">str</span>(game_ID) <span class="op">+</span> <span class="st">&#39;?embed=categories.variables&#39;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(URL,init_headers)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> response.json() <span class="co"># This has failed exactly once for reasons unknown</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Occurs if we get a throttling error. We wait 15 seconds then try again.</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;status&#39;</span> <span class="kw">in</span> data <span class="kw">and</span> data[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">420</span>:</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> <span class="st">&#39;status&#39;</span> <span class="kw">in</span> data <span class="kw">and</span> data[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">420</span>:</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                    time.sleep(sec)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                    response <span class="op">=</span> requests.get(URL,init_headers)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                    data <span class="op">=</span> response.json()</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If other error, print and move on</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The only error in my case was a game not being found, presumably being deleted between pulling the game and pulling the runs</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&#39;1b&#39;</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(data)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        game <span class="op">=</span> data[<span class="st">&#39;names&#39;</span>][<span class="st">&#39;international&#39;</span>]</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        cats <span class="op">=</span> data[<span class="st">&#39;categories&#39;</span>][<span class="st">&#39;data&#39;</span>]</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Finds all the runs for each category</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> categ <span class="kw">in</span> cats:</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> categ[<span class="st">&#39;id&#39;</span>] <span class="co"># Category ID</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>            cat_name <span class="op">=</span> categ[<span class="st">&#39;name&#39;</span>] <span class="co"># Category Name</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>            offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dir</span> <span class="op">=</span> <span class="st">&#39;asc&#39;</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>            fin <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>            sub_categories <span class="op">=</span> [] <span class="co"># Collection of the variables that define subcategories</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>            all_vars <span class="op">=</span> categ[<span class="st">&#39;variables&#39;</span>][<span class="st">&#39;data&#39;</span>] <span class="co"># Collects all variables of a run</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> var <span class="kw">in</span> all_vars:</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> var[<span class="st">&#39;is-subcategory&#39;</span>]:</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                    sub_categories.append(var[<span class="st">&#39;values&#39;</span>][<span class="st">&#39;values&#39;</span>])</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>            sub_keys <span class="op">=</span> {}</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> s <span class="kw">in</span> sub_categories:</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Assumed no two sub-categories in the same category will have the same variable ID</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>                temp_dict <span class="op">=</span> <span class="bu">dict</span>(s)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> t <span class="kw">in</span> temp_dict.keys():</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                    temp_dict[t] <span class="op">=</span> temp_dict[t][<span class="st">&#39;label&#39;</span>]</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                sub_keys.update(temp_dict)</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Collect data on every run. </span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span>(<span class="va">True</span>):</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Asks API for verified runs from this category, ordered by date submitted</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>                URL <span class="op">=</span> <span class="st">&#39;https://www.speedrun.com/api/v1/runs?game=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(game_ID) <span class="op">+</span> <span class="st">&#39;&amp;category=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(cat) <span class="op">+</span> <span class="st">&#39;&amp;orderby=submitted&amp;direction=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">dir</span>) <span class="op">+</span> <span class="st">&#39;&amp;status=verified&amp;max=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(maxim) <span class="op">+</span> <span class="st">&#39;&amp;offset=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(offset)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>                response <span class="op">=</span> requests.get(URL,init_headers)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>                data2 <span class="op">=</span> response.json()</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>                    data2 <span class="op">=</span> data2[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Throttling error. Wait 15 seconds and try again.</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;status&#39;</span> <span class="kw">in</span> data2 <span class="kw">and</span> data2[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">420</span>:</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">while</span> <span class="st">&#39;status&#39;</span> <span class="kw">in</span> data2 <span class="kw">and</span> data2[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">420</span>:</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>                            time.sleep(sec)</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>                            response <span class="op">=</span> requests.get(URL,init_headers)</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>                            data2 <span class="op">=</span> response.json()</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>                        data2 <span class="op">=</span> data2[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> <span class="st">&#39;times&#39;</span> <span class="kw">in</span> data2:</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>                        data2 <span class="op">=</span> data2</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># If other error, print and move on</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="dv">2</span>)</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(data2)</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> run <span class="kw">in</span> data2:</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Add game, category, time, date, and options</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>                    sub_cat <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># We store the label of the subcategory for ease of reading</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> var <span class="kw">in</span> run[<span class="st">&#39;values&#39;</span>].values():</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> var <span class="kw">in</span> sub_keys:</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>                            sub_cat.add(sub_keys[var])</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>                    df.loc[<span class="bu">len</span>(df.index)] <span class="op">=</span> [game, cat_name, run[<span class="st">&#39;times&#39;</span>][<span class="st">&#39;primary_t&#39;</span>], run[<span class="st">&#39;date&#39;</span>], sub_cat, game_ID, cat]</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If length of collected data is smaller than maximum we can collect, we&#39;re at the end of the list and break</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(data2) <span class="op">&lt;</span> maxim:</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Need to work from the back of the list if the offset is more than 10k (known bug)</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> offset <span class="op">+</span> maxim <span class="op">&gt;=</span> <span class="dv">10000</span>:</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>                    fin <span class="op">=</span> data2[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">dir</span> <span class="op">=</span> <span class="st">&#39;desc&#39;</span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>                    offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If we&#39;re working backwords and find the run we ended on going forward, we&#39;ve found all runs and break</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">dir</span> <span class="op">==</span> <span class="st">&#39;desc&#39;</span> <span class="kw">and</span> fin <span class="kw">in</span> data2:</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">dir</span> <span class="op">=</span> <span class="st">&#39;asc&#39;</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>                    fin <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If we collect 0 runs we break immediately (happens when no runs in category)</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span>(<span class="bu">len</span>(data2) <span class="op">==</span> <span class="dv">0</span>):</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>                offset <span class="op">+=</span> maxim</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the dates from a string to a datetime object, which is easier to use    </span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_convert(x):</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.isna(x):</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> np.nan</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.strptime(x, <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>)</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.strptime(x, <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>)</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="bu">type</span>(x))</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> [time_convert(x) <span class="cf">for</span> x <span class="kw">in</span> df[<span class="st">&#39;Date&#39;</span>]]</span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Game</th>
      <th>Category</th>
      <th>Run Time</th>
      <th>Date</th>
      <th>Values</th>
      <th>Game ID</th>
      <th>Cat ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bibi &amp; Tina: New Adventures With Horses</td>
      <td>Main Missions</td>
      <td>3531.0</td>
      <td>2022-04-21</td>
      <td>set()</td>
      <td>ldej22j1</td>
      <td>wdmm094d</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bibi &amp; Tina: New Adventures With Horses</td>
      <td>Main Missions</td>
      <td>3482.0</td>
      <td>2022-04-22</td>
      <td>set()</td>
      <td>ldej22j1</td>
      <td>wdmm094d</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bibi &amp; Tina: New Adventures With Horses</td>
      <td>Main Missions</td>
      <td>3396.0</td>
      <td>2022-04-23</td>
      <td>set()</td>
      <td>ldej22j1</td>
      <td>wdmm094d</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bibi &amp; Tina: New Adventures With Horses</td>
      <td>Main Missions</td>
      <td>3346.0</td>
      <td>2022-04-26</td>
      <td>set()</td>
      <td>ldej22j1</td>
      <td>wdmm094d</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Burger &amp; Frights</td>
      <td>Any%</td>
      <td>906.0</td>
      <td>2021-09-01</td>
      <td>set()</td>
      <td>3698y4ld</td>
      <td>zdnzx59d</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2580131</th>
      <td>暖雪 Warm Snow</td>
      <td>White Ash% NMG</td>
      <td>1045.0</td>
      <td>2022-04-19</td>
      <td>set()</td>
      <td>v1pxz946</td>
      <td>ndxnwvvk</td>
    </tr>
    <tr>
      <th>2580132</th>
      <td>暖雪 Warm Snow</td>
      <td>Fresh File% NMG</td>
      <td>2569.0</td>
      <td>2022-02-10</td>
      <td>set()</td>
      <td>v1pxz946</td>
      <td>vdoy5my2</td>
    </tr>
    <tr>
      <th>2580133</th>
      <td>暖雪 Warm Snow</td>
      <td>Fresh File% NMG</td>
      <td>2351.0</td>
      <td>2022-04-21</td>
      <td>set()</td>
      <td>v1pxz946</td>
      <td>vdoy5my2</td>
    </tr>
    <tr>
      <th>2580134</th>
      <td>暖雪 Warm Snow</td>
      <td>Fresh File% NMG</td>
      <td>1676.0</td>
      <td>2022-04-21</td>
      <td>set()</td>
      <td>v1pxz946</td>
      <td>vdoy5my2</td>
    </tr>
    <tr>
      <th>2580135</th>
      <td>鬼神童子ZENKI</td>
      <td>Any%</td>
      <td>1390.0</td>
      <td>2021-08-10</td>
      <td>set()</td>
      <td>9d387701</td>
      <td>5dw180ek</td>
    </tr>
  </tbody>
</table>
<p>2580136 rows × 7 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>80 hours and over 2.5 million runs later, we have finally finished data collection.</p>
</div>
<section id="exploratory-data-analysis" class="cell markdown" data-tags="[]">
<h2>Exploratory Data Analysis</h2>
</section>
<div class="cell markdown">
<p>To exam how the number of submitted runs changes with time, I decide to group them by month. I use the average length of month to split the data.</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split range of dates in to approximately 1 month bins</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> <span class="bu">int</span>(<span class="bu">round</span>((<span class="bu">max</span>(df[<span class="st">&#39;Date&#39;</span>])<span class="op">-</span><span class="bu">min</span>(df[<span class="st">&#39;Date&#39;</span>]))<span class="op">/</span>timedelta(weeks <span class="op">=</span> <span class="fl">4.345</span>),<span class="dv">0</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bins)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>605
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We see we have about 605 months worth of runs, now we can split the data between these months.</p>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut data into the bins based on submission date</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Date_Cut&#39;</span>] <span class="op">=</span> pd.cut(df.Date, bins <span class="op">=</span> bins)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We don&#39;t need to know full interval for graphing, take left endpoints</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> relabel(x):</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(x):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x.left</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Date_Cut&#39;</span>] <span class="op">=</span> [relabel(x) <span class="cf">for</span> x <span class="kw">in</span> df[<span class="st">&#39;Date_Cut&#39;</span>]]</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Finally, we plot the runs as a bar chart, with a bar for each month.</p>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many runs fall in each of the cuts</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> df[<span class="st">&#39;Date_Cut&#39;</span>].value_counts()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> <span class="bu">dict</span>(counts)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these counts</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Speedrun.Com&#39;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted&#39;</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/716f0711b30e86e052e455d858098394271f857a.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>This graph reveals several things, including both really old speedruns that were imported to Speedrun.com and runs that have plain errors in their input time (such as the run that supposedly submitted at the start of Unix time). To reel in the scope of this project, we will limit the data to runs that were submitted in 2014 or later, when Speedrun.com went online.</p>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset of more recent data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>rec <span class="op">=</span> df[df[<span class="st">&#39;Date&#39;</span>]  <span class="op">&gt;=</span> <span class="st">&#39;01-01-14&#39;</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many runs fall in each of the cuts</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>tot_counts <span class="op">=</span> rec[<span class="st">&#39;Date_Cut&#39;</span>].value_counts()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>tot_counts <span class="op">=</span> <span class="bu">dict</span>(tot_counts)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these counts</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>tot_counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Speedrun.Com&#39;</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted&#39;</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/4f3273abebc505bfcaf86e69542138897c2c543c.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>We see a rather large spike in 2020, that increases so rapidly it could be exponential. We can test this theory with a graph with a logarithmic y-axis:</p>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>tot_counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Speedrun.Com&#39;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&#39;log&#39;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted (log scale)&#39;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/3194875d36f781125b56e19b1331d7c99d44c43d.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Look at that! We can see a nearly linear relationship with this scale, suggesting the number of runs submitted to Speedrun.com is approximately exponential. Let's do the same thing with Minecraft.</p>
</div>
<div class="cell markdown">
<p>At this scale, we can see an explosion in the speedrunning scene as a whole, starting gradually from 2014, slowing around 2018, before a huge and sustained spike in submitted speedruns in 2020. We can also see if this matches for Minecraft as well.</p>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All runs with game ID associated with Minecraft: JE</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mine <span class="op">=</span> rec[rec[<span class="st">&#39;Game ID&#39;</span>] <span class="op">==</span> <span class="st">&#39;j1npme6p&#39;</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many runs fall in each of the cuts</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> mine[<span class="st">&#39;Date_Cut&#39;</span>].value_counts()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> <span class="bu">dict</span>(counts)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these counts</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Minecraft Leaderboards&#39;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted&#39;</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Minecraft Leaderboards&#39;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&#39;log&#39;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted (log_</span><span class="sc">{10}</span><span class="st">)&#39;</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/49e730d82ab1175b2a5804626668dd4f1e8f5bbd.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/242961f8dfc6de1cbc34b3a47da228bedcd0d87a.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Here we can see why people believed Minecraft speedrunning really took off after quarantine began. We see a modest number of runs continuously submitted up until 2019, then a gradual growth through 2020, then an explosion going into 2021. However the log graph shows the key differences between Minecraft and the Speedrun.com as a whole. While we could draw a general linear trend from 2013 to 2020, it appears to be quite weak. More importantly, we see a huge spike starting in 2020 and going into 2021, even on the log graph. This suggests that Minecraft surged in popularity exceedingly so, compared to its earlier years. Further, we see a sharp decline starting in 2021 and leading into 2022. These last two features differ drastically from the results in the overall Speedrun.com. This suggests that Minecraft's speedrunning popularity is different from the site as a whole, and we can show this quantitatively with linear regressions.</p>
</div>
<section id="linear-regressions" class="cell markdown" data-tags="[]">
<h2>Linear Regressions</h2>
</section>
<div class="cell markdown">
<p>We can use a linear regression to make an exponential fit of the Speedrun.com data by taking the log of the number of runs per month, then fitting a linear regression with respect to time. To start, let's copy the data we want: the months and the log of the number of runs in those months</p>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tot_freq <span class="op">=</span> pd.DataFrame.from_dict([<span class="bu">dict</span>(tot_counts)]).melt()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tot_freq.rename(columns <span class="op">=</span> {<span class="st">&#39;variable&#39;</span>: <span class="st">&#39;Month&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;Count&#39;</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take log</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>log_count <span class="op">=</span> {k: math.log(v) <span class="cf">for</span> k, v <span class="kw">in</span> counts.items()}</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#log_count = counts.apply(lambda x: math.log(x))</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&quot;Count&quot;</span>] <span class="op">=</span> tot_freq[<span class="st">&#39;Count&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: math.log10(x))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change how time is represented as datetime objects don&#39;t fit well with statsmodels</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>copy <span class="op">=</span> tot_freq[<span class="st">&#39;Month&#39;</span>].copy()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>mdates.date2num(tot_freq[<span class="st">&#39;Month&#39;</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>tot_freq.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18631.705785</td>
      <td>4.951022</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18783.672727</td>
      <td>4.945469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18662.099174</td>
      <td>4.929122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18692.492562</td>
      <td>4.925451</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18722.885950</td>
      <td>4.897220</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Note that the months are converted to a number, which is necessary for our linear regression. Speaking of which, we will now make a linear regression of all the data using just the log-count and the months.</p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tot_freq[<span class="st">&#39;Month&#39;</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> sm.OLS(tot_freq[<span class="st">&#39;Count&#39;</span>], X)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> mod.fit()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>res.params</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>const   -5.562301
Month    0.000554
dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>These parameters create a linear fit that looks like the following:</p>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&#39;res&#39;</span>] <span class="op">=</span> res.resid</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&#39;fit&#39;</span>] <span class="op">=</span> res.fittedvalues</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> copy</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>tot_freq <span class="op">=</span> tot_freq.sort_values(by <span class="op">=</span> <span class="st">&#39;Month&#39;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>ax.bar(tot_freq[<span class="st">&#39;Month&#39;</span>], tot_freq[<span class="st">&#39;Count&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Speedrun.com&#39;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted (log scale)&#39;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">2.5</span>,<span class="dv">5</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.yscale(&#39;log&#39;)</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.twinx()</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(ax.get_ylim())</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>ax2.plot(tot_freq[<span class="st">&#39;Month&#39;</span>], tot_freq[<span class="st">&#39;fit&#39;</span>], color<span class="op">=</span><span class="st">&#39;k&#39;</span>, label<span class="op">=</span><span class="st">&#39;Regression&#39;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/a062b0d100a451518d8431ecbe56989859f299be.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>That seems to match pretty close to expectations! We can also plot the fit on the original data by taking the exponent of the model's predictions.</p>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.bar(tot_freq[&#39;Month&#39;], tot_freq[&#39;Count&#39;], width = 31)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>tot_freq[<span class="st">&#39;exp_fit&#39;</span>] <span class="op">=</span> tot_freq[<span class="st">&#39;fit&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">10</span><span class="op">**</span>x)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.bar(<span class="op">*</span><span class="bu">zip</span>(<span class="op">*</span>tot_counts.items()), width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Speedrun.com&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted&#39;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.twinx()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(ax.get_ylim())</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax2.plot(tot_freq[<span class="st">&#39;Month&#39;</span>], tot_freq[<span class="st">&#39;exp_fit&#39;</span>], color<span class="op">=</span><span class="st">&#39;k&#39;</span>, label<span class="op">=</span><span class="st">&#39;Regression&#39;</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/2d4b2511fb0dc47b1245d1a5fc43d7029f6600e0.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>And finally, let's plot the residuals this fit produces:</p>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ax.bar(copy, tot_freq[<span class="st">&#39;res&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Residuals of Linear Model&#39;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Residual of log-count&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/66afa08f8adaa3246c39644210cb6ed4a34c4e90.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>These residuals suggest a pattern of dips and peaks in speedruns that our model doesn't capture, which may lie in the plethora of information outside of just the year (such as game genre, number of players, etc.). However despite this, the p-values don't lie:</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>res.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;P&gt;|t|&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>const    7.883564e-34
Month    2.025207e-54
Name: P&gt;|t|, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>These p-values are miniscule, giving very strong evidence that this correlation between year and number of submitted runs does exist.</p>
</div>
<div class="cell markdown">
<p>Now onto Minecraft, we will do the exact same analysis.</p>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> pd.DataFrame.from_dict([<span class="bu">dict</span>(counts)]).melt()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>freq.rename(columns <span class="op">=</span> {<span class="st">&#39;variable&#39;</span>: <span class="st">&#39;Month&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;Count&#39;</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take log</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>log_count <span class="op">=</span> {k: math.log(v) <span class="cf">for</span> k, v <span class="kw">in</span> counts.items()}</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#log_count = counts.apply(lambda x: math.log(x))</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&quot;Count&quot;</span>] <span class="op">=</span> freq[<span class="st">&#39;Count&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: math.log10(x))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change how time is represented as datetime objects don&#39;t fit well with statsmodels</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>copy <span class="op">=</span> freq[<span class="st">&#39;Month&#39;</span>].copy()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>mdates.date2num(freq[<span class="st">&#39;Month&#39;</span>])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> freq[<span class="st">&#39;Month&#39;</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> sm.OLS(freq[<span class="st">&#39;Count&#39;</span>], X)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> mod.fit()</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>res.params</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>const   -13.530621
Month     0.000842
dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;res&#39;</span>] <span class="op">=</span> res.resid</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;fit&#39;</span>] <span class="op">=</span> res.fittedvalues</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> copy</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> freq.sort_values(by <span class="op">=</span> <span class="st">&#39;Month&#39;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Runs Submitted to Minecraft Leaderboards&#39;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of runs submitted (log$_</span><span class="sc">{10}</span><span class="st">$)&#39;</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax.bar(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;Count&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.twinx()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(ax.get_ylim())</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>ax2.plot(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;fit&#39;</span>], color<span class="op">=</span><span class="st">&#39;k&#39;</span>, label<span class="op">=</span><span class="st">&#39;Regression&#39;</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/0918e8c483324ede6634de4a1361147ddabcfc29.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>We see it rres.paramsoughly follows the data, but with seemingly much looser a fit. Let's examine the residuals:</p>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ax.bar(copy, freq[<span class="st">&#39;res&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Residuals of Linear Model&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date Submitted&#39;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Residual of log-count&#39;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/2ab88aff688ae866bd90bb83fe739312ad0b9e22.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Compared to before, this model sees much higher residuals for Minecraft, with the same problems about breaking the assumptions about linear models. However a less sharp model could still be significant, let's look at the p-values</p>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>res.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;P&gt;|t|&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<pre><code>const    8.032060e-21
Month    3.208438e-23
Name: P&gt;|t|, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>These are miniscule, showing there is certainly a relationship between number of speedruns and time. However these values are quite different than those of the overall speedrunning community (STANDARDIZE BOTH AND COMPARE) so there must be something about minecraft affecting its results</p>
</div>
<div class="cell markdown">
<p>There must be another variable involved that explains Minecraft's surge and decline in runs. While quarantine obviously played a part, this would have played a similar role in the overall speedrunning scene yet we see a difference. So, I suggest another variable which boosted Minecraft only until its peak: Dream. To summarize, Dream is a very popular Minecraft Youtuber who, from 2019 through 2020, was Minecraft's most popular speedrunner. However, in December of 2020 it was found that <a href="https://mcspeedrun.com/dream.pdf">Dream had cheated</a> on his speedruns leading to him publically disavowing the community on Speedrun.com. We can notice how close December 2020 is to the peak we see of Minecraft speedrunning, so perhaps this could be an explantory variable.</p>
</div>
<div class="cell markdown">
<p>Dream uploaded his <a href="https://www.youtube.com/watch?v=CFkv6DtKf3w">first world record</a> on March 16, 2020, and the proof of his cheating were published on December 11, 2020. Thus we can consider time between these two to be "peak dream influence." We can add whether a month occured between these two dates to our model.</p>
</div>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>mdates.date2num(freq[<span class="st">&#39;Month&#39;</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> mdates.datestr2num(<span class="st">&#39;03/16/2020&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#mdates.date2num(freq[&#39;Month&#39;]) &#39;Mar 16, 2020&#39;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> mdates.datestr2num(<span class="st">&#39;12/11/2020&#39;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Dream&#39;</span>] <span class="op">=</span> freq[<span class="st">&#39;Month&#39;</span>].between(start,end)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 if month occurs in &#39;peak Dream,&#39; 0 otherwise</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Dream&#39;</span>] <span class="op">=</span> freq[<span class="st">&#39;Dream&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="cf">else</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We want to add an interaction term, as we are suggesting that the growth of speedrunning with respect to time changed when dream was popular.</p>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>y,X <span class="op">=</span> dmatrices(<span class="st">&#39;Count ~ Month*Dream&#39;</span>,freq, return_type <span class="op">=</span> <span class="st">&#39;dataframe&#39;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.ravel(y)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>X.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Intercept</th>
      <th>Month</th>
      <th>Dream</th>
      <th>Month:Dream</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>94</th>
      <td>1.0</td>
      <td>16078.661157</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>1.0</td>
      <td>16109.054545</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>1.0</td>
      <td>16139.447934</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1.0</td>
      <td>16169.841322</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>1.0</td>
      <td>16200.234711</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Now we fit the model</p>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> sm.OLS(y,X)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> mod.fit()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>fit.params</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<pre><code>Intercept     -12.196165
Month           0.000762
Dream         -35.893774
Month:Dream     0.001983
dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;res&#39;</span>] <span class="op">=</span> fit.resid</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;fit&#39;</span>] <span class="op">=</span> fit.fittedvalues</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> copy</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> freq.sort_values(by <span class="op">=</span> <span class="st">&#39;Month&#39;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>ax.bar(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;Count&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.twinx()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(ax.get_ylim())</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>ax2.plot(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;fit&#39;</span>], color<span class="op">=</span><span class="st">&#39;k&#39;</span>, label<span class="op">=</span><span class="st">&#39;Regression&#39;</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/ba27d3a2d35dfa2a0b9a4520d64a2e2ce01a2d63.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;P&gt;|t|&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">
<pre><code>Intercept      1.069543e-18
Month          6.716696e-21
Dream          3.788544e-01
Month:Dream    3.690292e-01
Name: P&gt;|t|, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>These p-values suggest the dream sweetspot isn't significant, despite how nice the graph looks. but what if we also added the the time after Dream was caught cheating, when he had told his fans not to associate with the leaderboard anymore?This is the period after he was caught cheating, before he <a href="https://www.looper.com/432321/dreams-minecraft-speedrun-cheating-scandal-explained/">admitted to it</a> on May 30, 2021.</p>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>mdates.date2num(freq[<span class="st">&#39;Month&#39;</span>])</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Cheat&#39;</span>] <span class="op">=</span> freq[<span class="st">&#39;Month&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> end <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>freq.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
      <th>res</th>
      <th>fit</th>
      <th>Dream</th>
      <th>Cheat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>94</th>
      <td>16078.661157</td>
      <td>0.000000</td>
      <td>-0.058446</td>
      <td>0.058446</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>16109.054545</td>
      <td>0.477121</td>
      <td>0.395511</td>
      <td>0.081610</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>16139.447934</td>
      <td>0.301030</td>
      <td>0.196255</td>
      <td>0.104775</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>16169.841322</td>
      <td>0.000000</td>
      <td>-0.127940</td>
      <td>0.127940</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>16200.234711</td>
      <td>0.477121</td>
      <td>0.326016</td>
      <td>0.151105</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>y,X <span class="op">=</span> dmatrices(<span class="st">&#39;Count ~ Month*Dream + Month*Cheat&#39;</span>,freq, return_type <span class="op">=</span> <span class="st">&#39;dataframe&#39;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.ravel(y)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> sm.OLS(y,X)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> mod.fit()</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>fit.params</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<pre><code>Intercept      -6.464687
Month           0.000423
Dream         -41.625253
Month:Dream     0.002322
Cheat          61.912920
Month:Cheat    -0.003224
dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;P&gt;|t|&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<pre><code>Intercept      2.191631e-07
Month          9.302297e-09
Dream          1.660017e-01
Month:Dream    1.535356e-01
Cheat          5.530645e-06
Month:Cheat    7.928875e-06
Name: P&gt;|t|, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;res&#39;</span>] <span class="op">=</span> fit.resid</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;fit&#39;</span>] <span class="op">=</span> fit.fittedvalues</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> copy</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> freq.sort_values(by <span class="op">=</span> <span class="st">&#39;Month&#39;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>ax.bar(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;Count&#39;</span>], width <span class="op">=</span> <span class="dv">31</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.twinx()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(ax.get_ylim())</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>ax2.plot(freq[<span class="st">&#39;Month&#39;</span>], freq[<span class="st">&#39;fit&#39;</span>], color<span class="op">=</span><span class="st">&#39;k&#39;</span>, label<span class="op">=</span><span class="st">&#39;Regression&#39;</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/4e564292d08ee73c3fde21ccafaa88edd4484de0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>freq</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
      <th>res</th>
      <th>fit</th>
      <th>Dream</th>
      <th>Cheat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>94</th>
      <td>2014-01-08 15:52:03.966942208</td>
      <td>0.000000</td>
      <td>-0.341937</td>
      <td>0.341937</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2014-02-08 01:18:32.727272704</td>
      <td>0.477121</td>
      <td>0.122318</td>
      <td>0.354804</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2014-03-10 10:45:01.487603200</td>
      <td>0.301030</td>
      <td>-0.066640</td>
      <td>0.367670</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2014-04-09 20:11:30.247933952</td>
      <td>0.000000</td>
      <td>-0.380537</td>
      <td>0.380537</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>2014-05-10 05:37:59.008264448</td>
      <td>0.477121</td>
      <td>0.083718</td>
      <td>0.393403</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021-12-05 00:47:36.198347008</td>
      <td>2.627366</td>
      <td>0.290902</td>
      <td>2.336464</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2022-01-04 10:14:04.958677760</td>
      <td>2.594393</td>
      <td>0.343041</td>
      <td>2.251351</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2022-02-03 19:40:33.719008256</td>
      <td>2.227887</td>
      <td>0.061648</td>
      <td>2.166239</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2022-03-06 05:07:02.479338752</td>
      <td>1.602060</td>
      <td>-0.479066</td>
      <td>2.081126</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2022-04-05 14:33:31.239669504</td>
      <td>1.602060</td>
      <td>-0.393954</td>
      <td>1.996014</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>97 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="33">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>copy</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>0    2021-02-04 02:22:48.595041280
1    2021-03-06 11:49:17.355371776
2    2021-01-04 16:56:19.834710784
3    2021-04-05 21:15:46.115702528
4    2021-05-06 06:42:14.876033024
                  ...             
92   2015-12-08 17:01:05.454545408
93   2016-03-08 21:20:31.735537152
94   2014-01-08 15:52:03.966942208
95   2014-10-09 04:50:22.809917440
96   2014-04-09 20:11:30.247933952
Name: Month, Length: 97, dtype: datetime64[ns]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>freq[<span class="st">&#39;res&#39;</span>] <span class="op">=</span> fit.resid</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots()</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>ax.bar(copy, freq[<span class="st">&#39;res&#39;</span>], width <span class="op">=</span> <span class="dv">30</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_9b39106894f042958a75814385dd054a/dd785d1b65c31cbd3be6ed63a574d21a93bc1936.png" /></p>
</div>
</div>
<div class="cell code">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="35">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>freq</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
      <th>res</th>
      <th>fit</th>
      <th>Dream</th>
      <th>Cheat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>94</th>
      <td>2014-01-08 15:52:03.966942208</td>
      <td>0.000000</td>
      <td>-0.341937</td>
      <td>0.341937</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2014-02-08 01:18:32.727272704</td>
      <td>0.477121</td>
      <td>0.122318</td>
      <td>0.354804</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2014-03-10 10:45:01.487603200</td>
      <td>0.301030</td>
      <td>-0.066640</td>
      <td>0.367670</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2014-04-09 20:11:30.247933952</td>
      <td>0.000000</td>
      <td>-0.380537</td>
      <td>0.380537</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>2014-05-10 05:37:59.008264448</td>
      <td>0.477121</td>
      <td>0.083718</td>
      <td>0.393403</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021-12-05 00:47:36.198347008</td>
      <td>2.627366</td>
      <td>0.290902</td>
      <td>2.336464</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2022-01-04 10:14:04.958677760</td>
      <td>2.594393</td>
      <td>0.343041</td>
      <td>2.251351</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2022-02-03 19:40:33.719008256</td>
      <td>2.227887</td>
      <td>0.061648</td>
      <td>2.166239</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2022-03-06 05:07:02.479338752</td>
      <td>1.602060</td>
      <td>-0.479066</td>
      <td>2.081126</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2022-04-05 14:33:31.239669504</td>
      <td>1.602060</td>
      <td>-0.393954</td>
      <td>1.996014</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>97 rows × 6 columns</p>
</div>
</div>
</div>
<section id="discussion" class="cell markdown">
<h1>Discussion</h1>
</section>
<div class="cell code">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
